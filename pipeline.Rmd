---
title: "Compilation Report | Corpus of Resolutions: UN Security Council"
author: SeÃ¡n Fobbe
geometry: margin=3cm
fontsize: 11pt
papersize: a4
output:
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
    pandoc_args: --listings
    includes:
      in_header: tex/Preamble_EN.tex
      before_body: [temp/Definitions.tex, tex/Titlepage_Compilation.tex]
bibliography: temp/packages.bib
nocite: '@*'
---


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = TRUE,
                      message = TRUE,
                      collapse = TRUE,
                      comment = "#>")
```


```{r, results = "asis", echo = FALSE}
cat(readLines("README.md"),
    sep = "\n")
```


# Load Packages


```{r}

library(targets)
library(tarchetypes)
library(RcppTOML)
library(future)
library(data.table)
library(quanteda)
library(knitr)
library(kableExtra)
library(igraph)
library(ggraph)

tar_unscript()
```


# Preamble

## Definitions

```{r}

## Datestamp
datestamp <- Sys.Date()
print(datestamp)

## Date and Time (Begin)
begin.script <- Sys.time()

## Read Configuration
config <- RcppTOML::parseTOML("config.toml")
print(config)


# Define Analysis Folder
dir.analysis <- paste0(getwd(),
                       "/analysis")


```



## Clean Up

Deletes files in the output folder that do not match the datestamp.


```{r}

unlink(grep(datestamp,
            list.files("output",
                       full.names = TRUE),
            invert = TRUE,
            value = TRUE))


```




## Create Folders


```{r}

dirs <- c("output",
          "temp")

dir.create(dir.analysis, showWarnings = FALSE)

lapply(dirs, dir.create, showWarnings = FALSE)

```





## Write Package Citations

```{r}
knitr::write_bib(renv::dependencies()$Package,
                 "temp/packages.bib")
```



# Global Variables


## Define Packages

```{targets global-packages, tar_globals = TRUE}

tar_option_set(packages = c("tarchetypes",  # Additional targets functions
                            "RcppTOML",     # Read and write TOML files
                            "zip",          # Enhanced ZIP handling
							"testthat",     # Unit tests
							"rvest",        # Web Scraping
                            "knitr",        # Scientific reporting
                            "kableExtra",   # Enhanced kable tables
                            "ggplot2",      # Advanced data vizualization
							"ggraph",       # Graph visualization
                            "scales",       # Scaling of figures
                            "viridis",      # Viridis palette
                            "RColorBrewer", # ColorBrewer palett
							"pdftools",     # Extract PDF files
							"readtext",     # Read TXT files
                            "quanteda",     # Advanced computer linguistics
                            "quanteda.textstats", # Text statistics
                            "quanteda.textplots", # Text visualizations
                            "future",       # Parellel computing
                            "future.apply", # Higher-order functions for future
                            "data.table"    # Advanced tabular data processing
                            )
               )


tar_option_set(workspace_on_error = TRUE) # Save Workspace on Error
tar_option_set(format = "qs")

```



## Configuration


```{targets global-config, tar_globals = TRUE}

datestamp <- Sys.Date()

config <- RcppTOML::parseTOML("config.toml")


dir.analysis <- paste0(getwd(),
                       "/analysis")

## Caption for diagrams
caption <- paste("Fobbe/Ridi/Gasbarri | DOI:",
                 config$doi$data$version)


## Prefix for figure titles
prefix.figuretitle <- paste(config$project$shortname,
                            "| Version",
                            datestamp)

## File prefix
prefix.files <- paste0(config$project$shortname,
                       "_",
                       datestamp)


if (config$cores$max == TRUE){
    fullCores <- parallel::detectCores()
}


if (config$cores$max == FALSE){
    fullCores <- as.integer(config$cores$number)
}

```



## Define Functions

```{targets global-functions, tar_globals = TRUE}

lapply(list.files("functions", pattern = "\\.R$", full.names = TRUE), source)

```



## Define Metadata for TXT Files

```{targets global-txtvars, tar_globals = TRUE}

docvarnames <- c("body",
                 "doctype",
                 "res_no",
                 "year",
                 "language")

```




## Define Source Files

```{targets global-sourcefiles, tar_globals = TRUE}

files.source.raw <-  c(list.files(pattern = "\\.R$|\\.toml$|\\.md$|\\.Rmd$"),
					   "reports",
                       "data",
                       "functions",
                       "tex",
                       "gpg",
                       "buttons",
                       list.files(pattern = "renv\\.lock|\\.Rprofile",
                                  all.files = TRUE),
                       list.files("renv",
                                  pattern = "activate\\.R",
                                  full.names = TRUE))

```

# Pipeline: Construction




## File Read Targets

Defines targets that track and read input data files. Source files are not read into R, but tracked to serve as a trigger for rebuilding the relevant ZIP archive.



### Source Code

```{targets tar.file1}
tar_target(files.source,
           files.source.raw,
           format = "file")

```


### Changelog

```{targets tar.file2}
tar_target(changelog,
           "CHANGELOG.md",
           format = "file")
```



### Table of Record Pages (Stable)



```{targets tar.file3}
list(
    tar_target(csv.record.table,
               "data/UNSC_Record-Table_2636.csv",
               format = "file"),
    tar_target(record.table.stable,
               fread(csv.record.table))
)
```


### Table of Variables

All variables in the data set, including their description.


```{targets tar.file4}
list(
    tar_target(file.var_codebook,
               "data/CR-UNSC_Variables.csv",
               format = "file"),
    tar_target(dt.var_codebook,
               fread(file.var_codebook))
)
```






## Download



### Build Table of Record Pages (Final)


```{targets tar.download.recordtable}
tar_target(dt.record.final,
           f.record_table(recordtable.stable = record.table.stable,
                                 limit = 2640,
								 debug.toggle = config$debug$toggle,
								 debug.sample = config$debug$sample))
```




### Download HTML Records for Resolutions



```{targets tar.download.records.res}
tar_target(html.record.res,
                f.download(url = dt.record.final$url_record,
                           filename = paste0(dt.record.final$res_no, ".html"),
                           dir = "files/record_resolution",
                           sleep.min = 0.5,
                           sleep.max = 1,
                           retries = 3,
                           retry.sleep.min = 2,
                           retry.sleep.max = 5,
                           timeout = config$download$timeout,
                           debug.toggle = FALSE),
                format = "file")

```






### Parse Resolution HTML Records

```{targets tar.download.parse.res}
tar_target(dt.download,
           f.parse_records_full(html.record.res))
		   
```





### Download HTML Records for Drafts



```{targets tar.download.records.draft}
tar_target(html.record.draft,
                f.download(url = dt.download$url_record_draft,
                           filename = paste0(dt.download$res_no, ".html"),
                           dir = "files/record_draft",
                           sleep.min = 0.5,
                           sleep.max = 1,
                           retries = 3,
                           retry.sleep.min = 5,
                           retry.sleep.max = 10,
                           timeout = config$download$timeout,
                           debug.toggle = FALSE),
                format = "file")

```



### Download HTML Records for Meeting Records



```{targets tar.download.records.meeting}
tar_target(html.record.meeting,
                f.download(url = dt.download$url_record_meeting,
                           filename = paste0(dt.download$res_no, ".html"),
                           dir = "files/record_meeting",
                           sleep.min = 1,
                           sleep.max = 1.5,
                           retries = 3,
                           retry.sleep.min = 5,
                           retry.sleep.max = 10,
                           timeout = config$download$timeout,
                           debug.toggle = FALSE),
                format = "file")

```




### Parse Draft HTML Records

```{targets tar.download.parse.draft}
tar_target(url.draft,
           f.parse_records_url(html.record.draft,
                               prefix = "url_draft_"))

```




### Parse Meeting HTML Records

```{targets tar.download.parse.meeting}
tar_target(url.meeting,
           f.parse_records_url(html.record.meeting,
                               prefix = "url_meeting_"))
		   
```



### Finalize Download Table

```{targets tar.download.table.final}
tar_target(dt.download.final,
           f.download_table_finalize(dt.download = dt.download,
                                     dt.record = dt.record.final,
                                     url.meeting = url.meeting,
                                     url.draft = url.draft))


```



### Download Resolutions




```{targets tar.download}

values <- tibble::tibble(
                      name = c("ar", "zh", "en", "fr", "ru", "es"),
                      filename = c(quote(paste0(dt.download.final$doc_id, "_AR.pdf")),
                                   quote(paste0(dt.download.final$doc_id, "_ZH.pdf")),
                                   quote(paste0(dt.download.final$doc_id, "_EN.pdf")),
                                   quote(paste0(dt.download.final$doc_id, "_FR.pdf")),
                                   quote(paste0(dt.download.final$doc_id, "_RU.pdf")),
                                   quote(paste0(dt.download.final$doc_id, "_ES.pdf")))
                      url = c(quote(dt.download.final$url_res_ar),
                                quote(dt.download.final$url_res_zh),
                                quote(dt.download.final$url_res_en),
                                quote(dt.download.final$url_res_fr),
                                quote(dt.download.final$url_res_ru),
                                quote(dt.download.final$url_res_es)),
                      dir = c("files/pdf_res_ar",
                              "files/pdf_res_zh",
                              "files/pdf_res_en",
                              "files/pdf_res_fr",
                              "files/pdf_res_ru",
                              "files/pdf_res_es"))
                  )


zip.list <- tarchetypes::tar_map(unlist = FALSE,
                                 values = values,
                                 names = name,
                                 tar_target(pdf_res,
                                            f.download(url = url,
                                                       filename = filename,
                                                       dir = dir,
                                                       sleep.min = 0.3,
                                                       sleep.max = 1,
                                                       retries = 3,
                                                       retry.sleep.min = 2,
                                                       retry.sleep.max = 5,
                                                       timeout = config$download$timeout,
                                                       debug.toggle = FALSE),
                                            format = "file")
                                 )



```




<!-- **Arabic** -->

<!-- ```{targets tar.download.res.ar} -->
<!-- tar_target(pdf.res.ar, -->
<!--                 f.download(url = dt.download.final$url_res_ar, -->
<!--                            filename = paste0(dt.download.final$doc_id, "_AR.pdf"), -->
<!--                            dir = "files/pdf_res_ar", -->
<!--                            sleep.min = 0.3, -->
<!--                            sleep.max = 1, -->
<!--                            retries = 3, -->
<!--                            retry.sleep.min = 2, -->
<!--                            retry.sleep.max = 5, -->
<!--                            timeout = config$download$timeout, -->
<!--                            debug.toggle = FALSE), -->
<!--                 format = "file") -->

<!-- ``` -->



<!-- **Chinese** -->

<!-- ```{targets tar.download.res.zh} -->
<!-- tar_target(pdf.res.zh, -->
<!--                 f.download(url = dt.download.final$url_res_zh, -->
<!--                            filename = paste0(dt.download.final$doc_id, "_ZH.pdf"), -->
<!--                            dir = "files/pdf_res_zh", -->
<!--                            sleep.min = 0.3, -->
<!--                            sleep.max = 1, -->
<!--                            retries = 3, -->
<!--                            retry.sleep.min = 2, -->
<!--                            retry.sleep.max = 5, -->
<!--                            timeout = config$download$timeout, -->
<!--                            debug.toggle = FALSE), -->
<!--                 format = "file") -->

<!-- ``` -->



<!-- **English** -->

<!-- ```{targets tar.download.res.en} -->
<!-- tar_target(pdf.res.en, -->
<!--                 f.download(url = dt.download.final$url_res_en, -->
<!--                            filename = paste0(dt.download.final$doc_id, "_EN.pdf"), -->
<!--                            dir = "files/pdf_res_en", -->
<!--                            sleep.min = 0.3, -->
<!--                            sleep.max = 1, -->
<!--                            retries = 3, -->
<!--                            retry.sleep.min = 2, -->
<!--                            retry.sleep.max = 5, -->
<!--                            timeout = config$download$timeout, -->
<!--                            debug.toggle = FALSE), -->
<!--                 format = "file") -->

<!-- ``` -->


<!-- **French** -->

<!-- ```{targets tar.download.res.fr} -->
<!-- tar_target(pdf.res.fr, -->
<!--                 f.download(url = dt.download.final$url_res_fr, -->
<!--                            filename = paste0(dt.download.final$doc_id, "_FR.pdf"), -->
<!--                            dir = "files/pdf_res_fr", -->
<!--                            sleep.min = 0.3, -->
<!--                            sleep.max = 1, -->
<!--                            retries = 3, -->
<!--                            retry.sleep.min = 2, -->
<!--                            retry.sleep.max = 5, -->
<!--                            timeout = config$download$timeout, -->
<!--                            debug.toggle = FALSE), -->
<!--                 format = "file") -->

<!-- ``` -->




<!-- **Russian** -->

<!-- ```{targets tar.download.res.ru} -->
<!-- tar_target(pdf.res.ru, -->
<!--                 f.download(url = dt.download.final$url_res_ru, -->
<!--                            filename = paste0(dt.download.final$doc_id, "_RU.pdf"), -->
<!--                            dir = "files/pdf_res_ru", -->
<!--                            sleep.min = 0.3, -->
<!--                            sleep.max = 1, -->
<!--                            retries = 3, -->
<!--                            retry.sleep.min = 2, -->
<!--                            retry.sleep.max = 5, -->
<!--                            timeout = config$download$timeout, -->
<!--                            debug.toggle = FALSE), -->
<!--                 format = "file") -->

<!-- ``` -->


<!-- **Spanish** -->


<!-- ```{targets tar.download.res.es} -->
<!-- tar_target(pdf.res.es, -->
<!--                 f.download(url = dt.download.final$url_res_es, -->
<!--                            filename = paste0(dt.download.final$doc_id, "_ES.pdf"), -->
<!--                            dir = "files/pdf_res_es", -->
<!--                            sleep.min = 0.3, -->
<!--                            sleep.max = 1, -->
<!--                            retries = 3, -->
<!--                            retry.sleep.min = 2, -->
<!--                            retry.sleep.max = 5, -->
<!--                            timeout = config$download$timeout, -->
<!--                            debug.toggle = FALSE), -->
<!--                 format = "file") -->

<!-- ``` -->





### Download Drafts

```{targets tar.download.draft.en}
tar_target(pdf.draft.en,
                f.download(url = dt.download.final$url_draft_en,
                           filename = paste0(dt.download.final$doc_id, "_Draft_EN.pdf"),
                           dir = "files/pdf_draft_en",
                           sleep.min = 0.3,
                           sleep.max = 1,
                           retries = 3,
                           retry.sleep.min = 2,
                           retry.sleep.max = 5,
                           timeout = config$download$timeout,
                           debug.toggle = FALSE),
                format = "file")

```



### Download Meeting Records

```{targets tar.download.meeting.en}
tar_target(pdf.meeting.en,
                f.download(url = dt.download.final$url_meeting_en,
                           filename = paste0(dt.download.final$doc_id, "_MeetingRec_EN.pdf"),
                           dir = "files/pdf_meeting_en",
                           sleep.min = 0.3,
                           sleep.max = 1,
                           retries = 3,
                           retry.sleep.min = 2,
                           retry.sleep.max = 5,
                           timeout = config$download$timeout,
                           debug.toggle = FALSE),
                format = "file")

```



## Convert Targets



### Convert Resolutions to TXT and ingest into R


```{targets tar.convert1}

list(tar_target(txt.res.en,
                f.tar_pdf_extract(x = pdf.res.en,
                                  outputdir = "files/txt_res_en",
								  multicore = config$parallel$extractPDF,
                                  cores = fullCores),
                format = "file"),
     tar_target(dt.res.en,
                f.readtext(x = txt.res.en,
                           docvarnames = docvarnames))
     )

```


### Convert Drafts to TXT and ingest into R


```{targets tar.convert2}

list(tar_target(txt.draft.en,
                f.tar_pdf_extract(x = pdf.draft.en,
                                  outputdir = "files/txt_draft_en",
								  multicore = config$parallel$extractPDF,
                                  cores = fullCores),
                format = "file"),
     tar_target(dt.draft.en,
                f.readtext(x = txt.draft.en,
                           docvarnames = docvarnames))
     )

```


### Convert Meeting Records to TXT and ingest into R



```{targets tar.convert3}

list(tar_target(txt.meeting.en,
                f.tar_pdf_extract(x = pdf.meeting.en,
                                  outputdir = "files/txt_meeting_en",
								  multicore = config$parallel$extractPDF,
                                  cores = fullCores),
                format = "file"),
     tar_target(dt.meeting.en,
                f.readtext(x = txt.meeting.en,
                           docvarnames = docvarnames))
     )

```



## Enhance Targets




### Merge Data

```{targets tar.enhance.merge}

tar_target(dt.intermediate,
           f.merge_data(dt.res.en = dt.res.en,
                        dt.draft.en = dt.draft.en,
                        dt.meeting.en = dt.meeting.en,
                        dt.download = dt.download,
                        dt.record.final = dt.record.final))

```


### Create Variable \enquote{date}


```{targets tar.enhance.date}
tar_target(var_date,
           f.date(dt.intermediate$title))
```




### Create Variables \enquote{ncharacters, ntokens, ntypes, nsentences}

Calculates a number of classical linguistic statistics.


```{targets tar.enhance8}
tar_target(var_lingstats,
                f.lingstats(dt.intermediate,
                            multicore = config$parallel$lingsummarize,
                            cores = fullCores,
                            germanvars = FALSE))
```





### Create Constants

Creates a number of constants that contain important provenience information to be added to the data set. These are the version number, the version DOI, the concept DOI and the license. May become particularly relevant when merging individual rows from the data set with a larger data set.


```{targets tar.enhance9}
tar_target(var_constants,
           data.frame(version = as.character(datestamp),
                      doi_concept = config$doi$data$concept,
                      doi_version = config$doi$data$version,
                      license = as.character(config$license$data))[rep(1, nrow(dt.intermediate)),])
```





### Combine Additional Variables

```{targets tar.enhance10}
tar_target(vars_additional,
           data.table(date = var_date,
                      var_lingstats,
                      var_constants))

```


### Add Additional Variables to Main Data Set



```{targets tar.enhance11}
tar_target(dt.final,           
           f.finalize(dt.intermediate = dt.intermediate,
                      vars.additional = vars_additional,
                      varnames = dt.var_codebook$varname,
					  debug.toggle = config$debug$toggle))

```





### Create Variant: Metadata Only

Remove text variable to create a much smaller version of the data set with metadata only.



```{targets tar.enhance14}
tar_target(dt.final.meta,
           dt.final[, !c("text", "text_draft", "text_meeting")])

```





## Write Targets

Write finalized data sets and hash checksums to disk.



### Write CSV: Main Data Set

```{targets tar.write1}
tar_target(csv.final,
           f.tar_fwrite(x = dt.final,
                        filename = file.path("output",
                                             paste0(prefix.files,
                                                    "_EN_CSV_MainDataset.csv"))
                        )
           )
```



### Write CSV: Metadata Only


```{targets tar.write2}
tar_target(csv.meta,
           f.tar_fwrite(x = dt.final.meta,
                        filename = file.path("output",
                                             paste0(prefix.files,
                                                    "_EN_CSV_Metadata.csv"))
                        )
           )

```



### Write Bibtex


```{targets tar.write.bibtex.oscola}
tar_target(bibtex.oscola,
           f.bibtex(dt.final = dt.final,
                        filename = file.path("output",
                                             paste0(prefix.files,
                                                    "_EN_Bibtex_OSCOLA.bib"))
                        )
           )

```




## Report Targets


### Write \LaTeX Definitions


```{targets tar.report1}
tar_target(latexdefs,
           f.latexdefs(config,
                       dir = "temp",
                       version = datestamp),
	       format = "file")

```



### Summary Statistics for Linguistic Variables

```{targets tar.report2}
tar_target(lingstats.summary,
                f.lingstats_summary(dt.final,
                                    germanvars = FALSE))

```


### Write Report: Robustness Checks

```{targets tar.report3}
tarchetypes::tar_render(report.robustness,
                        file.path("reports",
                                  "RobustnessChecks.Rmd"),
                        output_file = file.path("../output",
                                                paste0(config$project$shortname,
                                                       "_",
                                                       datestamp,
                                                       "_RobustnessChecks.pdf")))

```



### Write Report: Codebook



```{targets tar.report4}
tarchetypes::tar_render(report.codebook,
                        file.path("reports",
                                  "Codebook.Rmd"),
                        output_file = file.path("../output",
                                                paste0(config$project$shortname,
                                                       "_",
                                                       datestamp,
                                                       "_Codebook.pdf")))

```










## ZIP Targets


### Create ZIP: Source Code


```{targets tar.zip1}
tar_target(zip.source,
           f.tar_zip(files.source,
                     filename = paste0(prefix.files,
                                       "_Source_Code.zip"),
                     dir = "output",
                     mode = "mirror"),
           format = "file")
```



### Create ZIP: Main Dataset CSV


```{targets tar.zip3}
tar_target(zip.csv.final,
                f.tar_zip(csv.final,
                              filename = gsub("\\.csv", "\\.zip", basename(csv.final)),
                              dir = "output",
                              mode = "cherry-pick"),
                format = "file")
```



### Create ZIP: Metadata Only CSV


```{targets tar.zip4}
tar_target(zip.csv.meta,
                f.tar_zip(csv.meta,
                              filename = gsub("\\.csv", "\\.zip", basename(csv.meta)),
                              dir = "output",
                              mode = "cherry-pick"),
                format = "file")
```


	

### Create ZIP: Resolutions (PDF Original)


```{targets tar.zip.pdf.res.original}
tar_target(zip.pdf.res.original,
           f.tar_zip(c(pdf.res.ar,
                       pdf.res.en,
                       pdf.res.es,
                       pdf.res.fr,
                       pdf.res.ru,
                       pdf.res.zh),
                     filename = paste0(prefix.files,
                                       "_Resolutions_PDF.zip"),
                     dir = "output",
                     mode = "mirror"),
           format = "file")
```


	

### Create ZIP: Resolutions (TXT)


```{targets tar.zip.txt}
tar_target(zip.txt,
           f.tar_zip(c(txt.res.en),
                     filename = paste0(prefix.files,
                                       "_TXT.zip"),
                     dir = "output",
                     mode = "mirror"),
           format = "file")
```




### Create ZIP: Drafts (PDF Original)


```{targets tar.zip.pdf.draft.original}
tar_target(zip.pdf.draft.original,
           f.tar_zip(c(pdf.draft.en),
                     filename = paste0(prefix.files,
                                       "_Drafts_PDF.zip"),
                     dir = "output",
                     mode = "mirror"),
           format = "file")
```


### Create ZIP: Meeting Records (PDF Original)


```{targets tar.zip.pdf.meeting.original}
tar_target(zip.pdf.meeting.original,
           f.tar_zip(c(pdf.meeting.en),
                     filename = paste0(prefix.files,
                                       "_MeetingRecords_PDF.zip"),
                     dir = "output",
                     mode = "mirror"),
           format = "file")
```





## Cryptographic Hashes

### Define ZIP-Archives to be Hashed


```{targets tar.hashes1}
tar_target(zip.all,
           c(zip.pdf.res.original,
             zip.pdf.draft.original,
             zip.pdf.meeting.original,
             zip.txt,
             zip.csv.final,
             zip.csv.meta,
             zip.source))
```

### Calculate Cryptographic Hashes


```{targets tar.hashes2}
tar_target(hashes,
           f.tar_multihashes(c(zip.all,
                               report.codebook[1],
                               report.robustness[1]),
                             multicore = config$parallel$multihashes,
                             cores = fullCores))
```



### Write CSV: Cryptographic Hashes


```{targets tar.hashes3}
tar_target(csv.hashes,
           f.tar_fwrite(x = hashes,
                        filename = file.path("output",
                                             paste0(prefix.files,
                                                    "_CryptographicHashes.csv"))
                        )
           )
```









# Pipeline: Compilation



## Run Pipeline

```{r pipeline-run, results = "hide"}
tar_make()
```



## Visualization

```{r, pipeline-graph, width = 9, height = 9}

edgelist <- tar_network(targets_only = TRUE)$edges
setDT(edgelist)

g  <- igraph::graph.data.frame(edgelist,
                               directed = TRUE)


ggraph(g,
       'dh') + 
    geom_edge_diagonal(colour = "grey")+
    geom_node_point()+
    geom_node_text(aes(label = name),
                   size = 2,
                   repel = TRUE)+
    theme_void()

```
                       




# Pipeline: Analysis


## Full List



```{r, pipeline-list}

meta <- tar_meta(fields = c("type", "bytes"), complete_only = TRUE)
setDT(meta)
meta$MB <- round(meta$bytes / 1e6, digits = 2)

kable(meta[order(type, name)],
      format = "latex",
      align = "r",
      booktabs = TRUE,
      longtable = TRUE) %>% kable_styling(latex_options = "repeat_header")


```

\newpage
## Timing


```{r, pipeline-timing}

meta <- tar_meta(fields = c("time", "seconds"), complete_only = TRUE)
setDT(meta)

kable(meta[order(-seconds)],
      format = "latex",
      align = "r",
      booktabs = TRUE,
      longtable = TRUE) %>% kable_styling(latex_options = "repeat_header")


```

## Duration

```{r, pipeline-runtime}
runtime.sum <- sum(meta$seconds)

## Seconds
print(runtime.sum)

## Minutes
runtime.sum / 60

## Hours
runtime.sum / 3600
```



\newpage
## Warnings


```{r, pipeling-warnings}

meta <- tar_meta(fields = "warnings", complete_only = TRUE)
setDT(meta)

kable(meta,
      format = "latex",
      align = "r",
      booktabs = TRUE,
      longtable = TRUE) %>% kable_styling(latex_options = "repeat_header")


```



## Errors

```{r, pipeline-errors}

meta <- tar_meta(fields = "error", complete_only = TRUE)
setDT(meta)

kable(meta,
      format = "latex",
      align = "r",
      booktabs = TRUE,
      longtable = TRUE) %>% kable_styling(latex_options = "repeat_header")


```












# Finalize

```{r}

## Date Stamp
print(datestamp) 

## Date and Time (Begin)
print(begin.script)


## Date and Time (End)
end.script <- Sys.time()
print(end.script)


## Runtime for Script
print(end.script - begin.script)

```


# Parameters for Strict Replications


```{r}
system2("openssl", "version", stdout = TRUE)

sessionInfo()

```


# Bibliography
